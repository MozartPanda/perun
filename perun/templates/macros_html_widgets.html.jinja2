{% macro chip_list_style() %}
    .tag {
        display: inline-block;
        background-color: #e0e0e0;
        border-radius: 4px;
        padding: 4px 8px;
        margin-right: 8px;
        margin-bottom: 8px;
    }
    .close-button {
        cursor: pointer;
    }
{% endmacro %}

{% macro chip_list(chip_list_name, header) %}
    <table style="width: 98%; margin: 0 1%;">
        <tr>
            <td class="key" style="width: 8%;">{{ header }}:</td>
            <td style="width: 90%;">
                <div id="{{ chip_list_name }}">
                <!-- MORE TAGS WILL BE ADDED HERE -->
                </div>
            </td>
        </tr>
    </table>
{% endmacro %}

{% macro add_to_chip_list() %}
    function addTag(chip_list_name, tag_name) {
        var tagList = document.getElementById(chip_list_name);

        var newTag = document.createElement('div');
        newTag.className = 'tag';
        newTag.textContent = tag_name;

        var closeButton = document.createElement('span');
        closeButton.closeName = 'close-button';
        closeButton.textContent = 'âŠ—';

        closeButton.onclick = function() {
            tagList.removeChild(newTag);
        }

        newTag.appendChild(closeButton);
        tagList.appendChild(newTag);
    }
{% endmacro %}

{% macro checkboxes(checkbox_list, checkbox_id, header) %}
    <table id="{{ checkbox_id }}">
        <tbody>
            <tr>
                <td class="key">{{ header }}:</td>
                {% for checkbox in checkbox_list %}
                    <td>
                    <label>
                        <input type="checkbox" name="{{ checkbox[0] }}", value="{{ checkbox[0] }}" checked>{{ checkbox[1] }}
                    </label>
                    </td>
                {%- endfor %}
            </tr>
        </tbody>
    </table >
{% endmacro %}

{% macro checkbox_handler() %}
    function isChecked(checkbox_name) {
        var checkbox = document.querySelector('input[name="' + checkbox_name + '"]');
        if (checkbox) {
            return checkbox.checked;
        }
        return false;
    }
{%- endmacro %}

{% macro radios(radio_list, radio_id, choice_id, header) %}
    <table id="{{ radio_id }}">
        <tbody>
        <tr>
            <td class="key">{{ header }}:</td>
            <td>
            {% for radio in radio_list %}
                <label>
                    <input type="radio" name="{{ choice_id }}" value="{{ radio[0] }}" {% if loop.index0 == 0 %}checked{% endif %}>
                    {{ radio[1] }}
                </label>
            {%- endfor %}
            </td>
        </tr>
        </tbody>
    </table>
{%- endmacro %}

{% macro get_radio_handler(handler_name, radio_id) %}
    function {{ handler_name }}() {
        var selectedValue = document.querySelector('input[name="{{ radio_id }}"]:checked').value;
        return selectedValue;
    }
{%- endmacro %}

{% macro range_picker_style() %}
    <!-- courtesy of:  https://medium.com/@predragdavidovic10/native-dual-range-slider-html-css-javascript-91e778134816 -->
.range_container {
  display: flex;
  flex-direction: column;
  width: 80%;
  margin: 35% auto;
}

.sliders_control {
  position: relative;
  min-height: 15px;
}

.form_control {
  position: relative;
  display: flex;
  justify-content: space-between;
  font-size: 14px;
  color: #635a5a;
}

input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  pointer-events: all;
  width: 14px;
  height: 14px;
  background-color: #fff;
  border-radius: 50%;
  box-shadow: 0 0 0 1px #C6C6C6;
  cursor: pointer;
}

input[type=range]::-moz-range-thumb {
  -webkit-appearance: none;
  pointer-events: all;
  width: 14px;
  height: 14px;
  background-color: #fff;
  border-radius: 50%;
  box-shadow: 0 0 0 1px #C6C6C6;
  cursor: pointer;
}

input[type=range]::-webkit-slider-thumb:hover {
  background: #f7f7f7;
}

input[type=range]::-webkit-slider-thumb:active {
  box-shadow: inset 0 0 3px #387bbe, 0 0 9px #387bbe;
  -webkit-box-shadow: inset 0 0 3px #387bbe, 0 0 9px #387bbe;
}

input[type="number"] {
  color: #8a8383;
  width: 50px;
  height: 30px;
  font-size: 12px;
  border: none;
}

input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
   opacity: 1;
}

input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  height: 2px;
  width: 100%;
  position: absolute;
  background-color: #C6C6C6;
  pointer-events: none;
}

#fromSlider {
  height: 0;
  z-index: 1;
}
{% endmacro %}

{% macro range_picker() %}
<div class="range_container">
    <div class="sliders_control">
        <input id="fromSlider" type="range" value="10" min="0" max="100"/>
        <input id="toSlider" type="range" value="40" min="0" max="100"/>
    </div>
    <div class="form_control">
        <div class="form_control_container">
            Min: <input class="form_control_container__time__input" type="number" id="fromInput" value="10" min="0" max="100"/>
        </div>
        <div class="form_control_container">
            Max: <input class="form_control_container__time__input" type="number" id="toInput" value="40" min="0" max="100"/>
        </div>
    </div>
</div>
{%- endmacro %}

{% macro range_handlers() %}
function controlFromInput(fromSlider, fromInput, toInput, controlSlider) {
    const [from, to] = getParsed(fromInput, toInput);
    fillSlider(fromInput, toInput, '#C6C6C6', '#25daa5', controlSlider);
    if (from > to) {
        fromSlider.value = to;
        fromInput.value = to;
    } else {
        fromSlider.value = from;
    }
}

function controlToInput(toSlider, fromInput, toInput, controlSlider) {
    const [from, to] = getParsed(fromInput, toInput);
    fillSlider(fromInput, toInput, '#C6C6C6', '#25daa5', controlSlider);
    setToggleAccessible(toInput);
    if (from <= to) {
        toSlider.value = to;
        toInput.value = to;
    } else {
        toInput.value = from;
    }
}

function controlFromSlider(fromSlider, toSlider, fromInput) {
  const [from, to] = getParsed(fromSlider, toSlider);
  fillSlider(fromSlider, toSlider, '#C6C6C6', '#25daa5', toSlider);
  if (from > to) {
    fromSlider.value = to;
    fromInput.value = to;
  } else {
    fromInput.value = from;
  }
}

function controlToSlider(fromSlider, toSlider, toInput) {
  const [from, to] = getParsed(fromSlider, toSlider);
  fillSlider(fromSlider, toSlider, '#C6C6C6', '#25daa5', toSlider);
  setToggleAccessible(toSlider);
  if (from <= to) {
    toSlider.value = to;
    toInput.value = to;
  } else {
    toInput.value = from;
    toSlider.value = from;
  }
}

function getParsed(currentFrom, currentTo) {
  const from = parseInt(currentFrom.value, 10);
  const to = parseInt(currentTo.value, 10);
  return [from, to];
}

function fillSlider(from, to, sliderColor, rangeColor, controlSlider) {
    const rangeDistance = to.max-to.min;
    const fromPosition = from.value - to.min;
    const toPosition = to.value - to.min;
    controlSlider.style.background = `linear-gradient(
      to right,
      ${sliderColor} 0%,
      ${sliderColor} ${(fromPosition)/(rangeDistance)*100}%,
      ${rangeColor} ${((fromPosition)/(rangeDistance))*100}%,
      ${rangeColor} ${(toPosition)/(rangeDistance)*100}%,
      ${sliderColor} ${(toPosition)/(rangeDistance)*100}%,
      ${sliderColor} 100%)`;
}

function setToggleAccessible(currentTarget) {
  const toSlider = document.querySelector('#toSlider');
  if (Number(currentTarget.value) <= 0 ) {
    toSlider.style.zIndex = 2;
  } else {
    toSlider.style.zIndex = 0;
  }
}

const fromSlider = document.querySelector('#fromSlider');
const toSlider = document.querySelector('#toSlider');
const fromInput = document.querySelector('#fromInput');
const toInput = document.querySelector('#toInput');
fillSlider(fromSlider, toSlider, '#C6C6C6', '#25daa5', toSlider);
setToggleAccessible(toSlider);

fromSlider.oninput = () => controlFromSlider(fromSlider, toSlider, fromInput);
toSlider.oninput = () => controlToSlider(fromSlider, toSlider, toInput);
fromInput.oninput = () => controlFromInput(fromSlider, fromInput, toInput, toSlider);
toInput.oninput = () => controlToInput(toSlider, fromInput, toInput, toSlider);
{%- endmacro %}